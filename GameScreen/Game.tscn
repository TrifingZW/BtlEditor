[gd_scene load_steps=27 format=3 uid="uid://c78ax6yhf632"]

[ext_resource type="Script" path="res://GameScreen/Scripts/Game.cs" id="1_mv65n"]
[ext_resource type="Script" path="res://GameScreen/Scripts/MapController.cs" id="1_tib5m"]
[ext_resource type="Texture2D" uid="uid://b3iwesxgjb4n4" path="res://Assets/Textures/pts/map_land.png" id="2_f42uu"]
[ext_resource type="Script" path="res://GameScreen/Scripts/CameraController.cs" id="2_n3m31"]
[ext_resource type="TileSet" uid="uid://f3y4463ptra3" path="res://GameScreen/TileSet.tres" id="3_dpsvd"]
[ext_resource type="Shader" path="res://GameScreen/Shader/LandShader.gdshader" id="4_fbyr2"]
[ext_resource type="Texture2D" uid="uid://cpahj6uo782rp" path="res://Assets/Textures/pts/map_sea.png" id="5_dsksy"]
[ext_resource type="Texture2D" uid="uid://bcdattkc7eire" path="res://Assets/Textures/UI/move.svg" id="8_st2wp"]
[ext_resource type="Script" path="res://GameScreen/Scripts/MapUIScripts/MapUI.cs" id="8_vjv26"]
[ext_resource type="Texture2D" uid="uid://c5uqnry1pxbk3" path="res://Assets/Textures/UI/select.svg" id="9_3ud52"]
[ext_resource type="Texture2D" uid="uid://vyfm4hd0b5e2" path="res://Assets/Textures/UI/multi.svg" id="10_x3imk"]
[ext_resource type="Script" path="res://GameScreen/Scripts/MapUIScripts/Single/ArmySingle.cs" id="12_ni0yi"]
[ext_resource type="Script" path="res://GameScreen/Scripts/MapUIScripts/Single/CitySingle.cs" id="13_t38vd"]
[ext_resource type="PackedScene" uid="uid://2un2y08h3sph" path="res://UserInterface/TreeBar.tscn" id="14_1irfd"]
[ext_resource type="Script" path="res://GameScreen/Scripts/DataUIScripts/DataUI.cs" id="14_q5mnu"]
[ext_resource type="Script" path="res://GameScreen/Scripts/MapUIScripts/Single/LandSingle.cs" id="14_qxfg2"]
[ext_resource type="Script" path="res://GameScreen/Scripts/Windows/EditWindow.cs" id="15_twsgt"]
[ext_resource type="Script" path="res://GameScreen/Scripts/DataUIScripts/CustomItemList/CountryItemList.cs" id="16_gx6sn"]
[ext_resource type="Script" path="res://GameScreen/Scripts/MapUIScripts/Multi/ArmyMulti.cs" id="16_p4sxu"]
[ext_resource type="Script" path="res://GameScreen/Scripts/MapUIScripts/Multi/CityMulti.cs" id="17_5lx2v"]
[ext_resource type="Script" path="res://GameScreen/Scripts/DataUIScripts/CustomItemList/FlagItemList.cs" id="17_vpoy1"]
[ext_resource type="Script" path="res://GameScreen/Scripts/Windows/BtlObjWindow.cs" id="20_150s2"]
[ext_resource type="Script" path="res://GameScreen/Scripts/Dialog.cs" id="22_52ur2"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_ffr3h"]
shader = ExtResource("4_fbyr2")

[sub_resource type="ViewportTexture" id="ViewportTexture_ddpdi"]
viewport_path = NodePath("SubViewport")

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_tpis0"]
bg_color = Color(0, 0, 0, 0)

[node name="Game" type="Node2D"]
script = ExtResource("1_mv65n")

[node name="MapController" type="CanvasGroup" parent="."]
script = ExtResource("1_tib5m")
metadata/TileWidth = 148
metadata/TileHeigth = 129
metadata/SideLength = 76

[node name="SeaRender" type="Sprite2D" parent="MapController"]
unique_name_in_owner = true
visibility_layer = 512
texture_repeat = 2
texture = ExtResource("5_dsksy")
centered = false
region_enabled = true

[node name="LandRender" type="Sprite2D" parent="MapController"]
unique_name_in_owner = true
visibility_layer = 2
material = SubResource("ShaderMaterial_ffr3h")
texture = SubResource("ViewportTexture_ddpdi")
centered = false

[node name="TileMap" type="TileMap" parent="MapController"]
unique_name_in_owner = true
tile_set = ExtResource("3_dpsvd")
format = 2
layer_0/name = "多选"
layer_1/name = "单选"
layer_1/tile_data = PackedInt32Array()
layer_2/name = "城市"
layer_2/tile_data = PackedInt32Array()
layer_3/name = "陷阱"
layer_3/tile_data = PackedInt32Array()

[node name="ArmyRender" type="Node2D" parent="MapController"]
unique_name_in_owner = true

[node name="FlagRender" type="Node2D" parent="MapController"]
unique_name_in_owner = true

[node name="GeneralRender" type="Node2D" parent="MapController"]
unique_name_in_owner = true

[node name="Camera2D" type="Camera2D" parent="."]
script = ExtResource("2_n3m31")

[node name="SubViewport" type="SubViewport" parent="."]
unique_name_in_owner = true
transparent_bg = true
render_target_update_mode = 1

[node name="Land" type="Sprite2D" parent="SubViewport"]
unique_name_in_owner = true
texture_repeat = 2
texture = ExtResource("2_f42uu")
centered = false
region_enabled = true

[node name="Topography" type="Node2D" parent="SubViewport"]
unique_name_in_owner = true

[node name="MapUI" type="CanvasLayer" parent="."]
layer = 0
script = ExtResource("8_vjv26")

[node name="MainPanel" type="PanelContainer" parent="MapUI"]
offset_right = 40.0
offset_bottom = 40.0

[node name="VBoxContainer" type="VBoxContainer" parent="MapUI/MainPanel"]
layout_mode = 2

[node name="Utils" type="TabBar" parent="MapUI/MainPanel/VBoxContainer"]
unique_name_in_owner = true
layout_mode = 2
focus_mode = 0
theme_override_constants/h_separation = 0
theme_override_font_sizes/font_size = 50
tab_count = 3
tab_alignment = 1
clip_tabs = false
tab_0/title = "移动"
tab_0/icon = ExtResource("8_st2wp")
tab_1/title = "选择"
tab_1/icon = ExtResource("9_3ud52")
tab_2/title = "多选"
tab_2/icon = ExtResource("10_x3imk")

[node name="DataContainer" type="PanelContainer" parent="MapUI"]
unique_name_in_owner = true
visible = false
custom_minimum_size = Vector2(800, 0)
anchors_preset = 11
anchor_left = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 0
grow_vertical = 2

[node name="VBoxContainer" type="VBoxContainer" parent="MapUI/DataContainer"]
layout_mode = 2

[node name="DataTabContainer" type="TabContainer" parent="MapUI/DataContainer/VBoxContainer"]
unique_name_in_owner = true
layout_mode = 2
size_flags_vertical = 3
theme_override_font_sizes/font_size = 50

[node name="军队" type="ScrollContainer" parent="MapUI/DataContainer/VBoxContainer/DataTabContainer"]
unique_name_in_owner = true
layout_mode = 2
mouse_filter = 0
mouse_force_pass_scroll_events = false
vertical_scroll_mode = 3
script = ExtResource("12_ni0yi")

[node name="城市" type="ScrollContainer" parent="MapUI/DataContainer/VBoxContainer/DataTabContainer"]
unique_name_in_owner = true
visible = false
layout_mode = 2
mouse_filter = 0
mouse_force_pass_scroll_events = false
vertical_scroll_mode = 3
script = ExtResource("13_t38vd")

[node name="地块" type="ScrollContainer" parent="MapUI/DataContainer/VBoxContainer/DataTabContainer"]
unique_name_in_owner = true
visible = false
layout_mode = 2
mouse_filter = 0
mouse_force_pass_scroll_events = false
vertical_scroll_mode = 3
script = ExtResource("14_qxfg2")

[node name="MultiContainer" type="PanelContainer" parent="MapUI"]
unique_name_in_owner = true
visible = false
anchors_preset = 11
anchor_left = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 0
grow_vertical = 2

[node name="ScrollContainer" type="ScrollContainer" parent="MapUI/MultiContainer"]
layout_mode = 2
mouse_filter = 0
mouse_force_pass_scroll_events = false
horizontal_scroll_mode = 0
vertical_scroll_mode = 3

[node name="VBoxContainer" type="VBoxContainer" parent="MapUI/MultiContainer/ScrollContainer"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3

[node name="MultiModeTab" type="TabBar" parent="MapUI/MultiContainer/ScrollContainer/VBoxContainer"]
layout_mode = 2
focus_mode = 0
theme_override_font_sizes/font_size = 50
tab_count = 3
clip_tabs = false
tab_0/title = "选中模式"
tab_1/title = "清除模式"
tab_2/title = "占位空体"

[node name="Clear" type="Button" parent="MapUI/MultiContainer/ScrollContainer/VBoxContainer"]
layout_mode = 2
focus_mode = 0
text = "清空选中"

[node name="CreatePanel" parent="MapUI/MultiContainer/ScrollContainer/VBoxContainer" instance=ExtResource("14_1irfd")]
layout_mode = 2

[node name="Button" parent="MapUI/MultiContainer/ScrollContainer/VBoxContainer/CreatePanel" index="0"]
text = "批量创建"

[node name="Layout" parent="MapUI/MultiContainer/ScrollContainer/VBoxContainer/CreatePanel/Panel/MarginContainer" index="0"]
theme_override_constants/separation = 0

[node name="CreateArmy" type="Button" parent="MapUI/MultiContainer/ScrollContainer/VBoxContainer/CreatePanel/Panel/MarginContainer/Layout" index="0"]
layout_mode = 2
focus_mode = 0
text = "创建军队"

[node name="CreateCity" type="Button" parent="MapUI/MultiContainer/ScrollContainer/VBoxContainer/CreatePanel/Panel/MarginContainer/Layout" index="1"]
layout_mode = 2
focus_mode = 0
text = "创建城市"

[node name="SetPanel" parent="MapUI/MultiContainer/ScrollContainer/VBoxContainer" instance=ExtResource("14_1irfd")]
unique_name_in_owner = true
layout_mode = 2

[node name="Button" parent="MapUI/MultiContainer/ScrollContainer/VBoxContainer/SetPanel" index="0"]
text = "批量设置"

[node name="SetArmyBar" parent="MapUI/MultiContainer/ScrollContainer/VBoxContainer/SetPanel/Panel/MarginContainer/Layout" index="0" instance=ExtResource("14_1irfd")]
unique_name_in_owner = true
layout_mode = 2

[node name="Button" parent="MapUI/MultiContainer/ScrollContainer/VBoxContainer/SetPanel/Panel/MarginContainer/Layout/SetArmyBar" index="0"]
text = "设置军队"

[node name="Layout" parent="MapUI/MultiContainer/ScrollContainer/VBoxContainer/SetPanel/Panel/MarginContainer/Layout/SetArmyBar/Panel/MarginContainer" index="0"]
theme_override_constants/separation = 0
script = ExtResource("16_p4sxu")

[node name="SetCityBar" parent="MapUI/MultiContainer/ScrollContainer/VBoxContainer/SetPanel/Panel/MarginContainer/Layout" index="1" instance=ExtResource("14_1irfd")]
unique_name_in_owner = true
layout_mode = 2

[node name="Button" parent="MapUI/MultiContainer/ScrollContainer/VBoxContainer/SetPanel/Panel/MarginContainer/Layout/SetCityBar" index="0"]
text = "设置城市"

[node name="Layout" parent="MapUI/MultiContainer/ScrollContainer/VBoxContainer/SetPanel/Panel/MarginContainer/Layout/SetCityBar/Panel/MarginContainer" index="0"]
theme_override_constants/separation = 0
script = ExtResource("17_5lx2v")

[node name="SetProvince" type="Button" parent="MapUI/MultiContainer/ScrollContainer/VBoxContainer/SetPanel/Panel/MarginContainer/Layout" index="2"]
layout_mode = 2
focus_mode = 0
text = "设置省规划"

[node name="SetBelong" type="Button" parent="MapUI/MultiContainer/ScrollContainer/VBoxContainer/SetPanel/Panel/MarginContainer/Layout" index="3"]
layout_mode = 2
focus_mode = 0
text = "设置归属"

[node name="DeletePanel" parent="MapUI/MultiContainer/ScrollContainer/VBoxContainer" instance=ExtResource("14_1irfd")]
layout_mode = 2

[node name="Button" parent="MapUI/MultiContainer/ScrollContainer/VBoxContainer/DeletePanel" index="0"]
text = "批量删除"

[node name="Layout" parent="MapUI/MultiContainer/ScrollContainer/VBoxContainer/DeletePanel/Panel/MarginContainer" index="0"]
theme_override_constants/separation = 0

[node name="DeleteArmy" type="Button" parent="MapUI/MultiContainer/ScrollContainer/VBoxContainer/DeletePanel/Panel/MarginContainer/Layout" index="0"]
layout_mode = 2
focus_mode = 0
text = "删除军队"

[node name="DeleteCity" type="Button" parent="MapUI/MultiContainer/ScrollContainer/VBoxContainer/DeletePanel/Panel/MarginContainer/Layout" index="1"]
layout_mode = 2
focus_mode = 0
text = "删除城市"

[node name="EditWindow" type="Window" parent="MapUI"]
unique_name_in_owner = true
initial_position = 1
size = Vector2i(400, 126)
visible = false
wrap_controls = true
keep_title_visible = true
script = ExtResource("15_twsgt")

[node name="MarginContainer" type="MarginContainer" parent="MapUI/EditWindow"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme_override_constants/margin_left = 16
theme_override_constants/margin_top = 16
theme_override_constants/margin_right = 16
theme_override_constants/margin_bottom = 16

[node name="VBoxContainer" type="VBoxContainer" parent="MapUI/EditWindow/MarginContainer"]
layout_mode = 2

[node name="SpinBox" type="SpinBox" parent="MapUI/EditWindow/MarginContainer/VBoxContainer"]
layout_mode = 2
update_on_text_changed = true

[node name="Button" type="Button" parent="MapUI/EditWindow/MarginContainer/VBoxContainer"]
layout_mode = 2
focus_mode = 0
text = "确定"

[node name="DataUI" type="CanvasLayer" parent="."]
visible = false
script = ExtResource("14_q5mnu")

[node name="BtlObjWindow" type="Window" parent="DataUI"]
unique_name_in_owner = true
title = "国家设置"
initial_position = 1
size = Vector2i(800, 800)
visible = false
wrap_controls = true
transient = true
exclusive = true
script = ExtResource("20_150s2")

[node name="ScrollContainer" type="ScrollContainer" parent="DataUI/BtlObjWindow"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="MarginContainer" type="MarginContainer" parent="DataUI/BtlObjWindow/ScrollContainer"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
theme_override_constants/margin_left = 16
theme_override_constants/margin_top = 16
theme_override_constants/margin_right = 16
theme_override_constants/margin_bottom = 16

[node name="VBoxContainer" type="VBoxContainer" parent="DataUI/BtlObjWindow/ScrollContainer/MarginContainer"]
layout_mode = 2

[node name="PanelContainer" type="PanelContainer" parent="DataUI"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="VBoxContainer" type="VBoxContainer" parent="DataUI/PanelContainer"]
layout_mode = 2
theme_override_constants/separation = 0

[node name="TabBar" type="TabBar" parent="DataUI/PanelContainer/VBoxContainer"]
layout_mode = 2
focus_mode = 0
theme_override_font_sizes/font_size = 60
tab_count = 2
tab_0/title = "国家列表"
tab_1/title = "国旗列表"

[node name="HSeparator" type="HSeparator" parent="DataUI/PanelContainer/VBoxContainer"]
layout_mode = 2

[node name="HBoxContainer" type="HBoxContainer" parent="DataUI/PanelContainer/VBoxContainer"]
layout_mode = 2
size_flags_vertical = 3

[node name="TabContainer" type="TabContainer" parent="DataUI/PanelContainer/VBoxContainer/HBoxContainer"]
unique_name_in_owner = true
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
theme_override_font_sizes/font_size = 60
theme_override_styles/panel = SubResource("StyleBoxFlat_tpis0")
tabs_visible = false
tab_focus_mode = 0

[node name="CountryItemList" type="ItemList" parent="DataUI/PanelContainer/VBoxContainer/HBoxContainer/TabContainer"]
unique_name_in_owner = true
layout_mode = 2
size_flags_vertical = 3
focus_mode = 0
mouse_force_pass_scroll_events = false
theme_override_font_sizes/font_size = 50
allow_reselect = true
icon_scale = 2.0
script = ExtResource("16_gx6sn")

[node name="FlagItemList" type="ItemList" parent="DataUI/PanelContainer/VBoxContainer/HBoxContainer/TabContainer"]
unique_name_in_owner = true
visible = false
layout_mode = 2
focus_mode = 0
mouse_force_pass_scroll_events = false
script = ExtResource("17_vpoy1")

[node name="PanelContainer" type="PanelContainer" parent="DataUI/PanelContainer/VBoxContainer/HBoxContainer"]
custom_minimum_size = Vector2(400, 0)
layout_mode = 2

[node name="VBoxContainer" type="VBoxContainer" parent="DataUI/PanelContainer/VBoxContainer/HBoxContainer/PanelContainer"]
layout_mode = 2

[node name="Button1" type="Button" parent="DataUI/PanelContainer/VBoxContainer/HBoxContainer/PanelContainer/VBoxContainer"]
layout_mode = 2
focus_mode = 0
text = "新建"

[node name="Button2" type="Button" parent="DataUI/PanelContainer/VBoxContainer/HBoxContainer/PanelContainer/VBoxContainer"]
layout_mode = 2
focus_mode = 0
text = "删除"

[node name="Button3" type="Button" parent="DataUI/PanelContainer/VBoxContainer/HBoxContainer/PanelContainer/VBoxContainer"]
layout_mode = 2
focus_mode = 0
text = "设置"

[node name="Button4" type="Button" parent="DataUI/PanelContainer/VBoxContainer/HBoxContainer/PanelContainer/VBoxContainer"]
layout_mode = 2
focus_mode = 0
text = "复制"

[node name="Dialog" type="ConfirmationDialog" parent="."]
title = "警告"
initial_position = 1
size = Vector2i(400, 186)
ok_button_text = "确定"
dialog_autowrap = true
cancel_button_text = "取消"
script = ExtResource("22_52ur2")

[connection signal="tab_selected" from="MapUI/MultiContainer/ScrollContainer/VBoxContainer/MultiModeTab" to="MapUI" method="MultiModeTabSelect"]
[connection signal="pressed" from="MapUI/MultiContainer/ScrollContainer/VBoxContainer/Clear" to="MapUI" method="MultiModeClear"]
[connection signal="pressed" from="MapUI/MultiContainer/ScrollContainer/VBoxContainer/CreatePanel/Panel/MarginContainer/Layout/CreateArmy" to="MapUI" method="MultiModeCreateArmy"]
[connection signal="pressed" from="MapUI/MultiContainer/ScrollContainer/VBoxContainer/CreatePanel/Panel/MarginContainer/Layout/CreateCity" to="MapUI" method="MultiModeCreateCity"]
[connection signal="pressed" from="MapUI/MultiContainer/ScrollContainer/VBoxContainer/SetPanel/Panel/MarginContainer/Layout/SetProvince" to="MapUI" method="MultiModeSetProvince"]
[connection signal="pressed" from="MapUI/MultiContainer/ScrollContainer/VBoxContainer/SetPanel/Panel/MarginContainer/Layout/SetBelong" to="MapUI" method="MultiModeSetBelong"]
[connection signal="pressed" from="MapUI/MultiContainer/ScrollContainer/VBoxContainer/DeletePanel/Panel/MarginContainer/Layout/DeleteArmy" to="MapUI" method="MultiModeDeleteArmy"]
[connection signal="pressed" from="MapUI/MultiContainer/ScrollContainer/VBoxContainer/DeletePanel/Panel/MarginContainer/Layout/DeleteCity" to="MapUI" method="MultiModeDeleteCity"]
[connection signal="tab_changed" from="DataUI/PanelContainer/VBoxContainer/TabBar" to="DataUI" method="TabSelect"]
[connection signal="pressed" from="DataUI/PanelContainer/VBoxContainer/HBoxContainer/PanelContainer/VBoxContainer/Button1" to="DataUI" method="Add"]
[connection signal="pressed" from="DataUI/PanelContainer/VBoxContainer/HBoxContainer/PanelContainer/VBoxContainer/Button2" to="DataUI" method="Delete"]
[connection signal="pressed" from="DataUI/PanelContainer/VBoxContainer/HBoxContainer/PanelContainer/VBoxContainer/Button3" to="DataUI" method="Set"]
[connection signal="pressed" from="DataUI/PanelContainer/VBoxContainer/HBoxContainer/PanelContainer/VBoxContainer/Button4" to="DataUI" method="Set"]

[editable path="MapUI/MultiContainer/ScrollContainer/VBoxContainer/CreatePanel"]
[editable path="MapUI/MultiContainer/ScrollContainer/VBoxContainer/SetPanel"]
[editable path="MapUI/MultiContainer/ScrollContainer/VBoxContainer/SetPanel/Panel/MarginContainer/Layout/SetArmyBar"]
[editable path="MapUI/MultiContainer/ScrollContainer/VBoxContainer/SetPanel/Panel/MarginContainer/Layout/SetCityBar"]
[editable path="MapUI/MultiContainer/ScrollContainer/VBoxContainer/DeletePanel"]
